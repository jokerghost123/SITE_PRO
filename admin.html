<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - FULL TECH</title>

<script src="https://cdn.onesignal.com/sdks/web/v16/OneSignal.SDK.js" defer></script>
<script>
window.OneSignalDeferred = window.OneSignalDeferred || [];
OneSignalDeferred.push(async function(OneSignal) {
await OneSignal.init({
appId: "a8937c96-c30c-4896-b701-abb0e1daec26",
safari_web_id: "web.onesignal.auto.10425c27-7f99-4d6d-886d-06606087b7a8",
notifyButton: {
enable: true, // Affiche une petite cloche en bas à droite
},
});
});
</script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root {
--dark-bg: #0f172a;
--card-bg: #1e293b;
--accent-color: #3b82f6;
--admin-msg: #2563eb;
--client-msg: #334155;
}

body {
background: var(--dark-bg);
color: #f8fafc;
font-family: 'Segoe UI', sans-serif;
padding-bottom: 40px;
}

.admin-header {
background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
padding: 30px;
border-bottom: 2px solid var(--accent-color);
border-radius: 0 0 30px 30px;
margin-bottom: 30px;
}

.admin-title {
text-transform: uppercase;
font-weight: 800;
background: linear-gradient(to right, #60a5fa, #3b82f6);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
display: flex;
align-items: center;
justify-content: center;
gap: 15px;
}

.chat-container {
background: var(--card-bg);
height: 500px;
border-radius: 20px;
display: flex;
flex-direction: column;
border: 1px solid rgba(255,255,255,0.1);
}

#chat {
flex: 1;
overflow-y: auto;
padding: 20px;
display: flex;
flex-direction: column;
gap: 10px;
}

.msg {
max-width: 80%;
padding: 10px 15px;
border-radius: 15px;
font-size: 0.9rem;
}

.me { background: var(--admin-msg); align-self: flex-end; }
.other { background: var(--client-msg); align-self: flex-start; }

.input-area { padding: 15px; background: #1e293b; border-radius: 0 0 20px 20px; }
.form-control { background: #0f172a !important; color: white !important; border: 1px solid #334155 !important; }
</style>
</head>
<body>

<div class="admin-header text-center">
<h2 class="admin-title"><i class="fa-solid fa-user-shield"></i> FULL TECH ADMIN</h2>
</div>

<div class="container">
<div class="chat-container">
<div id="chat"></div>
<form id="msgForm" class="input-area">
<div class="input-group">
<input type="text" id="messageInput" class="form-control" placeholder="Répondre..." required>
<button class="btn btn-primary" type="submit">Envoyer</button>
</div>
</form>
</div>
</div>

<script>
const chat = document.getElementById("chat");
const msgForm = document.getElementById("msgForm");
const messageInput = document.getElementById("messageInput");

async function chargerMessages() {
const response = await fetch('/api/messages');
const messages = await response.json();
chat.innerHTML = "";
messages.forEach(msg => {
const div = document.createElement('div');
div.className = `msg ${msg.pseudo === "Admin" ? 'me' : 'other'}`;
div.innerHTML = `<small style="display:block; font-weight:bold">${msg.pseudo}</small>${msg.texte}`;
chat.appendChild(div);
});
chat.scrollTop = chat.scrollHeight;
}

msgForm.onsubmit = async (e) => {
e.preventDefault();
await fetch('/api/messages', {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({ texte: messageInput.value, pseudo: "Admin" })
});
messageInput.value = "";
chargerMessages();
};

setInterval(chargerMessages, 3000);
window.onload = chargerMessages;
</script>
</body>
</html>
